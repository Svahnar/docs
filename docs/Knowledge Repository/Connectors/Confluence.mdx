import { Steps, Step } from '@site/src/components/Steps/Steps';

# Confluence

Seamlessly import pages, hierarchies, and attachments from your Confluence workspace into the SVAHNAR Knowledge Repository.

This connector allows you to centralize internal documentation for Search, QA, and Knowledge Ops.

## üí° Core Concepts

Before configuring the connector, it is helpful to understand how SVAHNAR interacts with Confluence.

### 1. How does the Confluence Connector work?
The connector acts as a read-only ingestion tool. It connects to your Confluence instance using an API token, crawls the specified `space_key`, and normalizes the content (text, tables, and attachments) for the Knowledge Repository.

### 2. Permissions & Security
The connector respects Confluence permissions. It can only import content that the user/token has explicit access to.
* **Restricted Pages:** Will only be imported if the `token` belongs to a user with view access.
* **Storage:** SVAHNAR reads the data during ingestion; it does not permanently modify your Confluence instance.

---

## ‚öôÔ∏è Configuration Steps

Follow these steps to set up the connection and begin importing data.

<Steps>
  <Step>

### Prepare Confluence Credentials

  1. Log in to your Atlassian/Confluence account.
  2. Create an **API Token** (Atlassian Cloud) or a **Personal Access Token** (On-Prem).
  3. Ensure the account associated with the token has **Read** access to the Space you wish to import.

  :::info
  For Atlassian Cloud, we recommend using a Service Account rather than a personal user account to ensure continuity.
  :::
  </Step>

  <Step>

### Define Configuration Parameters

  You need to construct a `ConfluenceData` payload. Review the key parameters below:

  * **`url`**: The base URL of your instance (e.g., `https://yourcompany.atlassian.net/wiki`).
  * **`space_key`**: The specific space to import (e.g., `ENG`, `HR`).
  * **`token`**: Your secret API token.
  * **`username`**: The email or username associated with the token.

  **Optional Flags:**
  * `include_attachments`: Set to `true` to download PDFs, images, and docs.
  * `include_labels`: Useful for filtering search results later.
  * `include_restricted_content`: Attempts to read pages with specific view restrictions.
  </Step>

  <Step>

### Execute Import

  1. Pass your configuration payload to the Knowledge Repository connector tool.
  2. The connector will enumerate pages and begin the walk of the page hierarchy.
  3. Monitor the logs for any 403 (Forbidden) errors, which indicate permission issues on specific pages.

  </Step>
</Steps>

---

## üìö Practical Recipes (Examples)

### Recipe 1: Standard Space Import

> **Use Case:** Importing a public documentation space including attachments and keeping the formatting structure.

```json
{
  "url": "[https://yourcompany.atlassian.net/wiki](https://yourcompany.atlassian.net/wiki)",
  "token": "<REDACTED_API_TOKEN>",
  "space_key": "DOCS",
  "username": "svc-confluence@yourcompany.com",
  "keep_newlines": true,
  "include_labels": true,
  "include_comments": false,
  "include_archived_content": false,
  "include_restricted_content": false,
  "include_attachments": true
}

```

### üí° Tip: Managing Noise

If your Confluence pages have long comment threads that are not relevant to the knowledge base, keep `"include_comments": false` to improve search relevance.

---

## üöë Troubleshooting

* **401/403 Errors**
    * Check that the `username` matches the account that generated the `token`.
    * Verify the user has explicit *View* permissions for the target Space.


* **Missing Pages**
    * Ensure the `space_key` is correct.
    * If pages are archived, ensure `"include_archived_content": true` is set.
    * Some pages may be skipped if they contain complex, unsupported macros.


* **Rate Limiting (Slow Import)**
    * Confluence Cloud enforces strict API rate limits. Large spaces may throttle the import process.
    * If this occurs, consider importing the space in smaller batches or during off-peak hours.



